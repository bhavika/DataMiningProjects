from sklearn.feature_extraction import DictVectorizer
from sklearn.cluster import KMeans
from time import time
import numpy as np

# train_data = pd.read_csv('../data/input.csv', header=None)
# train_data['Spaces'] = train_data.applymap(lambda x: str.count(x, ' '))
# train_data['Words'] = train_data['Spaces']/2
#
# vectorizer = TfidfVectorizer(max_df=0.5, min_df=2, vocabulary=[str(i) for i in range(126373)])
#
# X = vectorizer.fit_transform(train_data[0].values)
# print X.shape


data = []

with open('../data/input.mat', 'r') as file:
    for i, line in enumerate(file):
        l = line.split()
        d = dict([(k, v) for k, v in zip(l[::2], l[1::2])])
        data.append(d)

v = DictVectorizer(sparse=False, dtype=float)
X = v.fit_transform(data)

start = time()

model = KMeans(init='k-means++', n_clusters=7, n_init=10, max_iter=100)
model.fit(X)


print "Cluster centers: "
print model.cluster_centers_


print "Cluster labels: "
print model.labels_
print type(model.labels_)

np.savetxt('../predictions/sklearn_kmns_1.txt', model.labels_, fmt='%i')

print "Elapsed time in seconds: ", time() - start


